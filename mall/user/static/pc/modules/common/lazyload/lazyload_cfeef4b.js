define("common/lazyload/lazyload",function(e,t,r){function n(e){var t=this,e=e||{};t.img_center=e.img_center||{},t.img_center_width=e.img_center.width||0,t.img_center_height=e.img_center.height||0,t.pre_load_165=e.pre_load_165||!1;var r=e.contain;if(!r)throw"ÉÐÎ´³õÊ¼»¯»¯lazyloadµÄ¸¸ÈÝÆ÷";return t.init(r,e),t}var i=e("components/jquery/jquery.js"),o=e("common/utility/index");n.prototype={init:function(e,t){var r=this;r.options=t,r.size=r.options.size,r.currentELE={},e?(this.container=e,r.freshELE(this.container),r.engine(),i(window).scroll(function(){r.engine()})):this.container=null},freshELE:function(e){var t=this;e=e||t.container;var r=i(e).find("[data-lazyload-url]"),n=[];r.each(function(e,r){var a=i(r).attr("data-lazyload-url");n[e]={url:a,obj:r},t.pre_load_165&&(n[e]=i.extend(!0,{},n[e],{url_165:o.matching_img_size(a,165)}))}),t.currentELE=n},engine:function(){for(var e=this,t=0;t<e.currentELE.length;t++)e.elementInViewport(e.currentELE[t].obj)&&e.loadImage(e.currentELE[t].obj,{size:e.size,callback:function(r){r.src==e.currentELE[t]&&e.currentELE[t].url&&e.currentELE.splice(t,1)},url_165:e.currentELE[t].url_165})},refresh:function(){var e=this;e.freshELE(),e.engine()},img_ready:function(e,t){var r=this,n=new Image;return n.src=e,n.complete?void(r.isFunction(t.load)&&t.load.call(n)):(n.onerror=function(){r.isFunction(t.error)&&t.error.call(n),n=n.onload=n.onerror=null},void(n.onload=function(){r.isFunction(t.load)&&t.load.call(n),n=n.onload=n.onerror=null}))},loadImage:function(e,t){var r=this,n=(new Image,e.getAttribute("data-lazyload-url"));t=t||{},n&&r.img_ready(n,{load:function(){console.log("Í¼Æ¬¼ÓÔØÍê³É");var o=this;i(e).hasClass("error")&&i(e).removeClass("error refresh");var a=e.getAttribute("data-size")||t.size,l=o.width,c=o.height;if(r.img_center.is_open)r.set_img_center(e,r.img_center_width,r.img_center_height);else if(a){var s=r.setImageSize(a,l,c);e.style.height=s+"px"}r.pre_load_165&&t.url_165&&(e.src=t.url_165),r._st=setTimeout(function(){"IMG"==e.tagName?e.src=n:e.style.backgroundImage="url("+n+")",i(e).addClass("loaded").removeAttr("data-lazyload-url")},500),"function"==typeof t.callback&&t.callback.call(r,o)},error:function(){console.log(n+"Í¼Æ¬¼ÓÔØÊ§°Ü");var t=this;i(e).addClass("error"),i(e).one("click",function(e){e.stopPropagation(),e.preventDefault(),t.retry=1,r.loadImage(t)}).addClass("refresh")}})},setImageSize:function(e,t,r){var n=parseInt(e),t=parseInt(t),r=parseInt(r),i=n*r/t;return i=parseInt(i)},elementInViewport:function(e){var t=e.getBoundingClientRect();return t.top>=0&&t.left>=0&&t.top<=(window.innerHeight||document.documentElement.clientHeight)},isFunction:function(e){return"function"==typeof e},set_img_center:function(e,t,r){var n=this,i=e.getAttribute("data-lazyload-url"),o=n.get_yue_img_size_from_url(i);t=parseInt(t),r=parseInt(r);var a=o.width,l=o.height;if(a/t>l/r){var c=r*a/l;e.style.width=c,e.style.height=r+"px",e.style.marginLeft=-(c-t)/2+"px"}else{var s=t*l/a;e.style.height=s,e.style.width=t+"px",e.style.marginTop=0>s-r-80?-(s-r)/2+"px":-(s-r)/2+50+"px"}},get_yue_img_size_from_url:function(e){var t=e.match(/\?(.*)/),r="",n="";if(t[1]){var i=t[1],o=i.match(/(\d+)x(\d+)_(\d+)/);return o[1]&&(r=o[1]),o[2]&&(n=o[2]),{width:r,height:n}}return{width:r,height:n}}},r.exports=n});