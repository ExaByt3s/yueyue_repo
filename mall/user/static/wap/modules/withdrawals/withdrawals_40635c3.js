define("withdrawals",function(n){"use strict";var t=n("common/utility/index"),e=n("components/zepto/zepto.js"),o=n("components/fastclick/fastclick.js"),i=(n("yue_ui/frozen"),n("common/I_APP/I_APP")),c=(n("common/scroll/index"),n("common/widget/abnormal/index"),n("menu/index"));"addEventListener"in document&&document.addEventListener("DOMContentLoaded",function(){o.attach(document.body)},!1),function(n,e){var o=n({});i.isPaiApp?i.check_login(function(n){var o=e.__YUE_APP_USER_INFO__,c=t.login_id,a=e.__YUE_APP_USER_INFO__.user_id||0,r=c==a;return console.log("=====local_user_id,client_user_id====="),console.log(c,a),t.ajax_request({url:e.$__config.ajax_url.auth_get_user_info,data:o,cache:!1,async:r}),t.int(n.pocoid)?void 0:void i.openloginpage(function(n){"0000"==n.code&&t.refresh_page()})}):t.auth.is_login()||(e.location.href="../../account/login.php?redirect_url="+encodeURIComponent(e.location.href));var a=[{index:0,content:"首页",click_event:function(){i.isPaiApp&&i.switchtopage({page:"hot"})}},{index:1,content:"刷新",click_event:function(){e.location.href=e.location.href}}];c.render(n("body"),a);var r=0;t.$_AppCallJSObj.on("__showTopBarMenu",function(){r++,r%2!=0?c.show():c.hide()});var s=function(){var n=this;n.init()};s.prototype={phone:"",init:function(){var t=this;o.$count_down=n('[data-role="btn-get"]'),o.$w_money=n('[data-role="w-money"]'),o.$third_account=n('[data-role="third-account"]'),o.$sms_code=n('[data-role="sms-code"]'),o.$tx_btn=n('[data-role="btn-tx"]'),t._setup_event()},_setup_event:function(){var t=this,i=e.innerHeight;console.log(i),e.onresize=function(){return e.innerHeight<i?(n(".footer-withdrawals").addClass("fn-hide"),!1):(n(".footer-withdrawals").removeClass("fn-hide"),!1)},o.$count_down.on("click",function(){o.counting||t.send_sms()}),o.on("success:fetch_sms",function(e,o){var i=o.result_data;1==i.code?(t.count_down(60),n('[data-role="change-phone"]').removeClass("fn-hide").html(i.data)):n.tips({content:i.msg,stayTime:3e3,type:"warn"})}).on("error:fetch_sms",function(){t.stop_count_down(),n.tips({content:"网络异常",stayTime:3e3,type:"warn"})}),o.$tx_btn.on("click",function(){var n=t.get_value_data();n&&t.withdraw_action(n)}),o.on("success:fetch_submit",function(t,o){var i=o.result_data;i.code>0?(n.tips({content:i.msg,stayTime:3e3,type:"success"}),setTimeout(function(){e.location.href="../bill/?type=withdraw"},2e3)):n.tips({content:i.msg,stayTime:3e3,type:"warn"})}).on("error:fetch_submit",function(){t.stop_count_down(),n.tips({content:"网络异常",stayTime:3e3,type:"warn"})})},refresh:function(){e.location.href=e.location.href},count_down:function(n){var t=this;o.counting=!0,o.$count_down.html(n),o.count_Interval=setInterval(function(){n--,0==n?(o.$count_down.html("重新获取"),t.stop_count_down(),o.counting=!1):o.$count_down.html(n)},1e3)},get_value_data:function(){var t=n.trim(o.$sms_code.val()),e=o.$third_account.val(),i=o.$w_money.val(),c=new RegExp(/^[\w-]+(\.[\w-]+)*@[\w-]+(\.[\w-]+)+$/),a=new RegExp(/^[0-9]{11}$/),r=new RegExp(/^[\u4E00-\u9FA5]+$/);if(""==i||r.test(i.trim()))return void n.tips({content:"请正确输入提现金额！",stayTime:3e3,type:"warn"});if(""==e||!c.test(e)&&!a.test(e))return void n.tips({content:"请正确输入支付宝账号！",stayTime:3e3,type:"warn"});if(""==t)return void n.tips({content:"请输入手机验证码！",stayTime:3e3,type:"warn"});var s=/^\d+$/,d=t.match(s);if(!d)return void n.tips({content:"验证码输入错误，验证码只能为数字!",stayTime:3e3,type:"warn"});var u={type:"money",amount:i,third_account:e,sms_code:t,is_money:1};return u},stop_count_down:function(){clearInterval(o.count_Interval)},send_sms:function(){o.sending||t.ajax_request({url:e.$__config.ajax_url.withdraw,data:{type:"sms"},beforeSend:function(t,e){o.$loading=n.loading({content:"发送中..."}),o.trigger("before:fetch_sms",t,e)},success:function(n,t){o.sending=!1,o.$loading.loading("hide"),o.trigger("success:fetch_sms",n,t)},error:function(n,t){o.sending=!1,o.$loading.loading("hide"),o.trigger("error:fetch_sms",n,t)}})},withdraw_action:function(i){o.sending||t.ajax_request({url:e.$__config.ajax_url.withdraw,data:i,beforeSend:function(t,e){o.$loading=n.loading({content:"发送中..."}),o.trigger("before:fetch_submit",t,e)},success:function(n,t){o.sending=!1,o.$loading.loading("hide"),o.trigger("success:fetch_submit",n,t)},error:function(n,t){o.sending=!1,o.$loading.loading("hide"),o.trigger("error:fetch_submit",n,t)}})}};new s}(e,window)});