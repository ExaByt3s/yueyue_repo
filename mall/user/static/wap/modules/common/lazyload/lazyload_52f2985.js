define("common/lazyload/lazyload",function(t,n,e){var r=t("components/zepto/zepto.js"),i=t("common/utility/index");!function(t,n){function r(t,n){var e=this;if(!t)throw"尚未初始化化lazyload的父容器";return n=n||{},e.init(t,n),e}function o(n,e){var r=new Image,i=n.getAttribute("data-lazyload-url"),c=this;e=e||{},r.src=i,r.onload=function(){t(n).hasClass("error")&&t(n).removeClass("error refresh");var o=n.getAttribute("data-size")||e.size,s=this.width,l=this.height;if(o){var u=a(o,s,l);n.style.height=u+"px"}c._st=setTimeout(function(){"IMG"==n.tagName?n.src=i:n.style.backgroundImage="url("+i+")",t(n).addClass("loaded")},500),"function"==typeof e.callback&&e.callback.call(c,r)},r.onerror=function(){t(n).addClass("error"),t(n).one("click",function(t){t.stopPropagation(),t.preventDefault(),r.retry=1,o(r)}).addClass("refresh")}}function a(t,n,e){var r=i.int(t),n=i.int(n),e=i.int(e),o=r*e/n;return o=i.int(o)}function c(t){var e=t.getBoundingClientRect();return e.top>=0&&e.left>=0&&e.top<=(n.innerHeight||document.documentElement.clientHeight)}r.prototype={init:function(e,r){var i=this;i.options=r,i.size=i.options.size,i.currentELE={},e?(this.container=e,i.freshELE(this.container),i.engine(),t(n).scroll(function(){i.engine()})):this.container=null},freshELE:function(n){var e=this;n=n||e.container;var r=t(n).find("[data-lazyload-url]"),i={};r.each(function(n,e){var r=t(e).attr("data-lazyload-url");i[r]={url:r,obj:e}}),e.currentELE=i},engine:function(){var t=this;for(var n in t.currentELE)c(t.currentELE[n].obj)&&o(t.currentELE[n].obj,{size:t.size,callback:function(n){n.src==t.currentELE[n.src]&&t.currentELE[n.src].url&&delete t.currentELE[n.src]}})},refresh:function(){var t=this;t.freshELE(),t.engine()}},e.exports=r}(r,window)});