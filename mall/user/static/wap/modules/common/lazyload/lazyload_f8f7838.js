define("common/lazyload/lazyload",function(n,t,r){var e=n("components/zepto/zepto.js"),o=n("common/utility/index");!function(n,t){function e(n,t){var r=this;if(!n)throw"尚未初始化化lazyload的父容器";return t=t||{},r.init(n,t),r}function a(t,r){var e=(new Image,t.getAttribute("data-lazyload-url")),o=this;r=r||{},e&&u(e,{load:function(){var a=this;n(t).hasClass("error")&&n(t).removeClass("error refresh");var l=t.getAttribute("data-size")||r.size,c=a.width,u=a.height;if(l){var s=i(l,c,u);t.style.height=s+"px"}o._st=setTimeout(function(){"IMG"==t.tagName?t.src=e:t.style.backgroundImage="url("+e+")",n(t).addClass("loaded").removeAttr("data-lazyload-url")},500),"function"==typeof r.callback&&r.callback.call(o,a)},error:function(){var r=this;n(t).addClass("error"),n(t).one("click",function(n){n.stopPropagation(),n.preventDefault(),r.retry=1,a(r)}).addClass("refresh")}})}function i(n,t,r){var e=o.int(n),t=o.int(t),r=o.int(r),a=e*r/t;return a=o.int(a)}function l(n){var r=n.getBoundingClientRect();return r.top>=0&&r.left>=0&&r.top<=(t.innerHeight||document.documentElement.clientHeight)}function c(n){return"function"==typeof n}function u(n,t){var r=new Image;return r.src=n,r.complete?void(c(t.load)&&t.load.call(r)):(r.onerror=function(){c(t.error)&&t.error.call(r),r=r.onload=r.onerror=null},void(r.onload=function(){c(t.load)&&t.load.call(r),r=r.onload=r.onerror=null}))}e.prototype={init:function(r,e){var o=this;o.options=e,o.size=o.options.size,o.currentELE={},r?(this.container=r,o.freshELE(this.container),o.engine(),n(t).scroll(function(){o.engine()})):this.container=null},freshELE:function(t){var r=this;t=t||r.container;var e=n(t).find("[data-lazyload-url]"),o={};e.each(function(t,r){var e=n(r).attr("data-lazyload-url");o[e]={url:e,obj:r}}),r.currentELE=o},engine:function(){var n=this;for(var t in n.currentELE)l(n.currentELE[t].obj)&&a(n.currentELE[t].obj,{size:n.size,callback:function(t){t.src==n.currentELE[t.src]&&n.currentELE[t.src].url&&delete n.currentELE[t.src]}})},refresh:function(){var n=this;n.freshELE(),n.engine()}},r.exports=e}(e,window)});