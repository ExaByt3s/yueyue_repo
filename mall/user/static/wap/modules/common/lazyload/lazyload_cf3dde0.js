define("common/lazyload/lazyload",function(t,r,n){var e=t("components/zepto/zepto.js"),o=t("common/utility/index");!function(t,r){function e(t,r){var n=this;if(!t)throw"尚未初始化化lazyload的父容器";return r=r||{},n.init(t,r),n}function i(r,n){var e=(new Image,r.getAttribute("data-lazyload-url")),o=this;n=n||{},e&&u(e,{load:function(){var i=this;t(r).hasClass("error")&&t(r).removeClass("error refresh");var l=r.getAttribute("data-size")||n.size,c=i.width,u=i.height;if(l){var s=a(l,c,u);r.style.height=s+"px"}o._st=setTimeout(function(){"IMG"==r.tagName?r.src=e:r.style.backgroundImage="url("+e+")","IMG"==r.tagName&&r.hasAttribute("height")&&r.removeAttribute("height"),t(r).addClass("loaded").removeAttr("data-lazyload-url")},250),"function"==typeof n.callback&&n.callback.call(o,i)},error:function(){var n=this;t(r).addClass("error"),t(r).one("click",function(t){t.stopPropagation(),t.preventDefault(),n.retry=1,i(n)}).addClass("refresh")}})}function a(t,r,n){var e=o.int(t),r=o.int(r),n=o.int(n),i=e*n/r;return i=o.int(i)}function l(t){var n=t.getBoundingClientRect();return n.top>=0&&n.left>=0&&n.top<=(r.innerHeight||document.documentElement.clientHeight)}function c(t){return"function"==typeof t}function u(t,r){var n=new Image;return n.src=t,n.complete?void(c(r.load)&&r.load.call(n)):(n.onerror=function(){c(r.error)&&r.error.call(n),n=n.onload=n.onerror=null},void(n.onload=function(){c(r.load)&&r.load.call(n),n=n.onload=n.onerror=null}))}e.prototype={init:function(n,e){var o=this;o.options=e,o.size=o.options.size,o.currentELE={},n?(this.container=n,o.freshELE(this.container),o.engine(),t(r).scroll(function(){o.engine()})):this.container=null},freshELE:function(r){var n=this;r=r||n.container;var e=t(r).find("[data-lazyload-url]"),o={};e.each(function(r,n){var e=t(n).attr("data-lazyload-url");o[r]={url:e,obj:n}}),n.currentELE=o},engine:function(){var t=this;if(t.currentELE)for(var r in t.currentELE)l(t.currentELE[r].obj)&&i(t.currentELE[r].obj,{size:t.size,callback:function(r){r.src==t.currentELE[r.src]&&t.currentELE[r.src].url&&delete t.currentELE[r.src]}})},refresh:function(){var t=this;t.freshELE(),t.engine()}},n.exports=e}(e,window)});