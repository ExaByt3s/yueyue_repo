define("search",function(e){var t=e("components/zepto/zepto.js"),s=e("common/utility/index"),n=Handlebars.template(function(e,t,s,n,a){function r(e,t){var n,a,r="";return r+='\n    <button data-role="btn" class="ui-button ui-button-size-x ui-button-bg-fff hot-btn" data-code-name="',(a=s.name)?n=a.call(e,{hash:{},data:t}):(a=e&&e.name,n=typeof a===i?a.call(e,{hash:{},data:t}):a),r+=c(n)+'">\n        <span class="ui-button-content">',(a=s.name)?n=a.call(e,{hash:{},data:t}):(a=e&&e.name,n=typeof a===i?a.call(e,{hash:{},data:t}):a),r+=c(n)+"</span>\n    </button>\n"}this.compilerInfo=[4,">= 1.0.0"],s=this.merge(s,e.helpers),a=a||{};var o,l="",i="function",c=this.escapeExpression,_=this;return l+="\n",o=s.each.call(t,(o=t&&t.data,null==o||o===!1?o:o.btn_list),{hash:{},inverse:_.noop,fn:_.program(1,r,a),data:a}),(o||0===o)&&(l+=o),l});t(document).ready(function(){function e(){}t('[data-role="page-back"]').on("click",function(){document.referrer?window.history.back():window.location.href="../index.php"}),document.body.addEventListener("touchstart",function(){});var a=t({});if(a.$search_merchant=t('[data-role="merchant"]'),a.$search_service=t('[data-role="service"]'),a.$hot_service_content=t('[data-role="hot-service-content"]'),a.$hot_seller_content=t('[data-role="hot-seller-content"]'),a.$history=t('[data-role="history"]'),a.$history_service_content=t('[data-role="history-service-content"]'),a.$history_seller_content=t('[data-role="history-seller-content"]'),a.$empty=t('[data-role="empty"]'),a.$type_btn=t('[data-role="type-btn"]'),a.$search_btn=t('[data-role="right-btn"]'),a.$search_text=t('[data-role="search-text"]'),a.$search_type_txt=t('[data-role="search-type"]').find("span"),a.$type_select=t("#type-select"),a.service_tags=window.__service_tags||[],a.service_btn_list=[],a.seller_tags=window.__seller_tags||[],a.seller_btn_list=[],a.service_tags.length>0)for(var r=0;r<a.service_tags.length;r++){var o={};o.name=a.service_tags[r],a.service_btn_list.push(o)}if(a.seller_tags.length>0)for(var r=0;r<a.seller_tags.length;r++){var o={};o.name=a.seller_tags[r],a.seller_btn_list.push(o)}a.type="goods",a.$type_btn.on("click",function(){var e="服务";a.type=t(this).attr("data-type"),a.$type_select.addClass("fn-hide"),"seller"==a.type?(e="商家",a.$hot_seller_content.removeClass("fn-hide"),a.$history_seller_content.removeClass("fn-hide"),a.$hot_service_content.addClass("fn-hide"),a.$history_service_content.addClass("fn-hide")):"goods"==a.type&&(e="服务",a.$hot_service_content.removeClass("fn-hide"),a.$history_service_content.removeClass("fn-hide"),a.$hot_seller_content.addClass("fn-hide"),a.$history_seller_content.addClass("fn-hide")),a.$search_type_txt.html(e)}),a.$search_btn.on("click",function(){var t=a.$search_text.val();return t?void e(t,a.type):void console.log("请输入内容")}),t('[data-role="search-type"]').on("click",function(e){e.stopPropagation(),a.$type_select.hasClass("fn-hide")?a.$type_select.removeClass("fn-hide"):a.$type_select.addClass("fn-hide")}),t(document).on("click",function(){a.$type_select.addClass("fn-hide")});var l=function(e){var t=this;e=e||{},t.options=e,t.init()};l.prototype={init:function(){{var n=this,r=n.options.data||[];n.options.key||""}n.$el=n.options.$el||{},"goods"==a.type?n.$el.lst_key="service-history":"seller"==a.type&&(n.$el.lst_key="seller-history");var o=(s.storage.get(n.$el.lst_key)||[],n.render_items(r));n.$el.html(o),a.$btn=n.$el.find('[data-role="btn"]'),a.$btn.on("click",function(n){var r=t(n.currentTarget),o=r.attr("data-code-name");if("goods"==a.type)var l="service-history";else if("seller"==a.type)var l="seller-history";for(var i=s.storage.get(l)||[],c=!1,_=0;_<i.length;_++)i[_].name==o&&(c=!0);c||(i.length>=3&&i.pop(),i.unshift({name:o}),s.storage.set(l,i)),e(o,a.type)}),a.$empty.on("click",function(){s.storage.remove(n.$el.lst_key),n.setup_empty()})},render_items:function(e){var t=n(e);return t},setup_search_click:function(){},setup_empty:function(){a.$history.html(""),a.$empty.hide()}},a.search_hot_service_items_child_obj=new l({key:"hot_service",data:{data:{btn_list:a.service_btn_list}},title:"",$el:a.$hot_service_content}),a.search_history_service_items_child_obj=new l({key:"history_service",data:{data:{btn_list:s.storage.get("service-history")||[]}},title:"",$el:a.$history_service_content}),a.search_hot_seller_items_child_obj=new l({key:"hot_seller",data:{data:{btn_list:a.seller_btn_list}},title:"",$el:a.$hot_seller_content}),a.search_history_seller_items_child_obj=new l({key:"history_seller",data:{data:{btn_list:s.storage.get("seller-history")||[]}},title:"",$el:a.$history_seller_content})})});