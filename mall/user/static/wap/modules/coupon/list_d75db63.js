define("coupon/list",function(e,a,n){"use strict";var t=e("common/utility/index"),o=e("components/zepto/zepto.js"),s=e("components/fastclick/fastclick.js"),r=(e("yue_ui/frozen"),e("common/I_APP/I_APP")),c=Handlebars.template(function(e,a,n,t,o){function s(e,a,t){var o,s,_="";return _+='\r\n    <div class="widget-coupon ',o=n["if"].call(e,e&&e._class_for_available,{hash:{},inverse:p.program(4,c,a),fn:p.program(2,r,a),data:a}),(o||0===o)&&(_+=o),_+=" ",o=n["if"].call(e,t&&t.no_choose_btn,{hash:{},inverse:p.noop,fn:p.program(6,i,a),data:a}),(o||0===o)&&(_+=o),_+='" data-coupon_sn="',(s=n.coupon_sn)?o=s.call(e,{hash:{},data:a}):(s=e&&e.coupon_sn,o=typeof s===u?s.call(e,{hash:{},data:a}):s),_+=v(o)+'">\r\n        <div class="left-border">\r\n            <div class="inside"></div>\r\n        </div>\r\n        <div class="price" data-role="to_ticket_details_price">\r\n            <div class="type">',(s=n.scope_module_type_name)?o=s.call(e,{hash:{},data:a}):(s=e&&e.scope_module_type_name,o=typeof s===u?s.call(e,{hash:{},data:a}):s),_+=v(o)+'</div>\r\n            <div class="contain">\r\n                <div class="contain-left">',(s=n.coin)?o=s.call(e,{hash:{},data:a}):(s=e&&e.coin,o=typeof s===u?s.call(e,{hash:{},data:a}):s),_+=v(o)+'</div>\r\n                <div class="contain-right">',(s=n.face_value)?o=s.call(e,{hash:{},data:a}):(s=e&&e.face_value,o=typeof s===u?s.call(e,{hash:{},data:a}):s),_+=v(o)+'</div>\r\n            </div>\r\n        </div>\r\n        <div class="split">\r\n            <div class="top"></div>\r\n            <div class="mid"><div class="mid-in"></div></div>\r\n            <div class="bottom"></div>\r\n        </div>\r\n        <div class="details" data-role="to_ticket_details">\r\n            <div class="notice">',(s=n.batch_name)?o=s.call(e,{hash:{},data:a}):(s=e&&e.batch_name,o=typeof s===u?s.call(e,{hash:{},data:a}):s),(o||0===o)&&(_+=o),_+='</div>\r\n            <div class="date">',(s=n.start_time_str)?o=s.call(e,{hash:{},data:a}):(s=e&&e.start_time_str,o=typeof s===u?s.call(e,{hash:{},data:a}):s),_+=v(o)+"-",(s=n.end_time_str)?o=s.call(e,{hash:{},data:a}):(s=e&&e.end_time_str,o=typeof s===u?s.call(e,{hash:{},data:a}):s),_+=v(o)+'</div>\r\n        </div>\r\n        <div class="choosen_btn ',o=n["if"].call(e,e&&e.can_select,{hash:{},inverse:p.program(8,d,a),fn:p.program(2,r,a),data:a}),(o||0===o)&&(_+=o),_+='" data-role="choosen_btn">\r\n            <div class="tap" data-role="tap">\r\n                <div class="tap-in">\r\n                    <i class="icon icon-right-24x16 fn-hide"></i>\r\n                    <label class="ui-yue-checkbox">\r\n                        <i data-role="cb-btn" ',o=n["if"].call(e,e&&e.selected,{hash:{},inverse:p.program(10,l,a),fn:p.program(2,r,a),data:a}),(o||0===o)&&(_+=o),_+=' type="checkbox"  ></i>\r\n                    </label>\r\n                </div>\r\n            </div>\r\n        </div>\r\n        <div class="right-border">\r\n            <div class="inside"></div>\r\n        </div>\r\n    </div>\r\n'}function r(){var e="";return e}function c(){return"unavailable"}function i(){return"no_choose_btn"}function d(){return"fn-hide"}function l(){return'class="no-selected" checked=""'}this.compilerInfo=[4,">= 1.0.0"],n=this.merge(n,e.helpers),o=o||{};var _,h="",p=this,u="function",v=this.escapeExpression;return _=n.each.call(a,a&&a.data,{hash:{},inverse:p.noop,fn:p.programWithDepth(1,s,o,a),data:o}),(_||0===_)&&(h+=_),h+="\r\n"}),i=e("common/widget/abnormal/index");"addEventListener"in document&&document.addEventListener("DOMContentLoaded",function(){s.attach(document.body)},!1),r.isPaiApp&&r.check_login(function(e){return t.int(e.pocoid)?void 0:void r.openloginpage(function(e){"0000"==e.code&&t.refresh_page()})});var d={};n.exports={render:function(e,a){var n=this;return a.length>0&&(a[0].selected=!0,d[a[0].coupon_sn]=a[0],n.selected_coupon=d[a[0].coupon_sn]),o.each(a,function(e,n){"available"==n.tab?a[e]=o.extend(!0,{},n,{_class_for_available:!0}):"used"==n.tab?a[e]=o.extend(!0,{},n,{_class_for_used:!0}):"expired"==n.tab&&(a[e]=o.extend(!0,{},n,{_class_for_expired:!0})),d[n.coupon_sn]=n}),e.html(""),a.length?e.html(c({data:a})):i.render(o('[data-role="coupon-list-container"]')[0],{message:n.message}),n.setup_event(),this},refresh:function(){var e=this,a=o.loading({content:"º”‘ÿ÷–..."}),n={order_sn:e.order_sn,order_total_amount:e.order_total_amount,order_pay_amount:e.order_pay_amount,page:e.page};n=o.extend({},n,e.extend_params,!0),t.ajax_request({url:window.$__config.ajax_url.get_user_coupon_list_by_check,type:"GET",data:n,success:function(n){var t=n.result_data;e.message=t.message,e.render(e.$container,t.list),a.loading("hide")},error:function(){a.loading("hide"),o.tips({content:"Õ¯¬Á“Ï≥£",stayTime:3e3,type:"warn"})}})},page_back:function(){},init:function(e){var a=this;return a.$container=e.container||{},a.order_sn=e.order_sn||"",a.order_total_amount=e.order_total_amount||"",a.order_pay_amount=e.order_pay_amount||"",a.page=e.page||1,a.extend_params=e.extend_params||{},a.can_select=e.can_select||!1,a.refresh(),a},hide:function(){},setup_event:function(){var e=this;o("[data-coupon_sn]").on("click",function(a){var n=o(a.currentTarget),t=n.attr("data-coupon_sn"),s=n.find('[type="checkbox"]');s.hasClass("no-selected")?(o("[data-coupon_sn]").find('[type="checkbox"]').attr("checked","").addClass("no-selected"),s.removeAttr("checked").removeClass("no-selected"),e.selected_coupon=d[t]):(s.attr("checked","").addClass("no-selected"),e.selected_coupon="")})}}});