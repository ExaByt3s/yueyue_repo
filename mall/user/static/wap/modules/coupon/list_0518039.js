define("coupon/list",function(e,a,n){"use strict";var t=e("common/utility/index"),s=e("components/zepto/zepto.js"),o=e("components/fastclick/fastclick.js"),r=(e("yue_ui/frozen"),e("common/I_APP/I_APP")),c=Handlebars.template(function(e,a,n,t,s){function o(e,a,t){var s,o,_="";return _+='\r\n    <div class="widget-coupon ',s=n["if"].call(e,e&&e._class_for_available,{hash:{},inverse:u.program(4,c,a),fn:u.program(2,r,a),data:a}),(s||0===s)&&(_+=s),_+=" ",s=n["if"].call(e,t&&t.no_choose_btn,{hash:{},inverse:u.noop,fn:u.program(6,i,a),data:a}),(s||0===s)&&(_+=s),_+='" data-coupon_sn="',(o=n.coupon_sn)?s=o.call(e,{hash:{},data:a}):(o=e&&e.coupon_sn,s=typeof o===p?o.call(e,{hash:{},data:a}):o),_+=v(s)+'">\r\n        <div class="left-border">\r\n            <div class="inside"></div>\r\n        </div>\r\n        <div class="price" data-role="to_ticket_details_price">\r\n            <div class="type">',(o=n.scope_module_type_name)?s=o.call(e,{hash:{},data:a}):(o=e&&e.scope_module_type_name,s=typeof o===p?o.call(e,{hash:{},data:a}):o),_+=v(s)+'</div>\r\n            <div class="contain">\r\n                <div class="contain-left">',(o=n.coin)?s=o.call(e,{hash:{},data:a}):(o=e&&e.coin,s=typeof o===p?o.call(e,{hash:{},data:a}):o),_+=v(s)+'</div>\r\n                <div class="contain-right">',(o=n.face_value)?s=o.call(e,{hash:{},data:a}):(o=e&&e.face_value,s=typeof o===p?o.call(e,{hash:{},data:a}):o),_+=v(s)+'</div>\r\n            </div>\r\n        </div>\r\n        <div class="split">\r\n            <div class="top"></div>\r\n            <div class="mid"><div class="mid-in"></div></div>\r\n            <div class="bottom"></div>\r\n        </div>\r\n        <div class="details" data-role="to_ticket_details">\r\n            <div class="notice">',(o=n.batch_name)?s=o.call(e,{hash:{},data:a}):(o=e&&e.batch_name,s=typeof o===p?o.call(e,{hash:{},data:a}):o),(s||0===s)&&(_+=s),_+='</div>\r\n            <div class="date">',(o=n.start_time_str)?s=o.call(e,{hash:{},data:a}):(o=e&&e.start_time_str,s=typeof o===p?o.call(e,{hash:{},data:a}):o),_+=v(s)+"-",(o=n.end_time_str)?s=o.call(e,{hash:{},data:a}):(o=e&&e.end_time_str,s=typeof o===p?o.call(e,{hash:{},data:a}):o),_+=v(s)+'</div>\r\n        </div>\r\n        <div class="choosen_btn ',s=n["if"].call(e,e&&e.can_select,{hash:{},inverse:u.program(8,d,a),fn:u.program(2,r,a),data:a}),(s||0===s)&&(_+=s),_+='" data-role="choosen_btn">\r\n            <div class="tap" data-role="tap">\r\n                <div class="tap-in">\r\n                    <i class="icon icon-right-24x16 fn-hide"></i>\r\n                    <label class="ui-yue-checkbox">\r\n                        <i data-role="cb-btn" ',s=n["if"].call(e,e&&e.selected,{hash:{},inverse:u.program(10,l,a),fn:u.program(2,r,a),data:a}),(s||0===s)&&(_+=s),_+=' type="checkbox"  ></i>\r\n                    </label>\r\n                </div>\r\n            </div>\r\n        </div>\r\n        <div class="right-border">\r\n            <div class="inside"></div>\r\n        </div>\r\n    </div>\r\n'}function r(){var e="";return e}function c(){return"unavailable"}function i(){return"no_choose_btn"}function d(){return"fn-hide"}function l(){return'class="no-selected" checked=""'}this.compilerInfo=[4,">= 1.0.0"],n=this.merge(n,e.helpers),s=s||{};var _,h="",u=this,p="function",v=this.escapeExpression;return _=n.each.call(a,a&&a.data,{hash:{},inverse:u.noop,fn:u.programWithDepth(1,o,s,a),data:s}),(_||0===_)&&(h+=_),h+="\r\n"}),i=e("common/widget/abnormal/index");"addEventListener"in document&&document.addEventListener("DOMContentLoaded",function(){o.attach(document.body)},!1),r.isPaiApp&&r.check_login(function(e){return t.int(e.pocoid)?void 0:void r.openloginpage(function(e){"0000"==e.code&&t.refresh_page()})});var d={};n.exports={render:function(e,a){var n=this;return a.length>0&&(a[0].selected=!0,d[a[0].coupon_sn]=a[0],n.selected_coupon=d[a[0].coupon_sn]),s.each(a,function(e,n){"available"==n.tab?a[e]=s.extend(!0,{},n,{_class_for_available:!0}):"used"==n.tab?a[e]=s.extend(!0,{},n,{_class_for_used:!0}):"expired"==n.tab&&(a[e]=s.extend(!0,{},n,{_class_for_expired:!0})),d[n.coupon_sn]=n}),e.html(""),a.length?e.html(c({data:a})):i.render(s('[data-role="coupon-list-container"]')[0],{message:n.message}),n.setup_event(),this},refresh:function(){var e=this,a=s.loading({content:"º”‘ÿ÷–..."}),n={order_sn:e.order_sn,order_total_amount:e.order_total_amount,order_pay_amount:e.order_pay_amount,page:e.page};n=s.extend({},n,e.extend_params,!0),t.ajax_request({url:window.$__config.ajax_url.get_user_coupon_list_by_check,type:"GET",data:n,success:function(n){var t=n.result_data;e.message=t.message,e.render(e.$container,t.list),e.success.call(this,n),a.loading("hide")},error:function(){a.loading("hide"),s.tips({content:"Õ¯¬Á“Ï≥£",stayTime:3e3,type:"warn"})}})},page_back:function(){},init:function(e){var a=this;return a.$container=e.container||{},a.order_sn=e.order_sn||"",a.order_total_amount=e.order_total_amount||"",a.order_pay_amount=e.order_pay_amount||"",a.page=e.page||1,a.extend_params=e.extend_params||{},a.can_select=e.can_select||!1,a.success=e.success||function(){},a.refresh(),a},hide:function(){},setup_event:function(){var e=this;s("[data-coupon_sn]").on("click",function(a){var n=s(a.currentTarget),t=n.attr("data-coupon_sn"),o=n.find('[type="checkbox"]');o.hasClass("no-selected")?(s("[data-coupon_sn]").find('[type="checkbox"]').attr("checked","").addClass("no-selected"),o.removeAttr("checked").removeClass("no-selected"),e.selected_coupon=d[t]):(o.attr("checked","").addClass("no-selected"),e.selected_coupon="")})}}});