define("comment_list_act",function(n){"use strict";function a(n){var a=this;a.options=n||{},a.init()}var e=n("common/utility/index"),t=n("components/zepto/zepto.js"),o=n("components/fastclick/fastclick.js"),i=(n("yue_ui/frozen"),n("common/scroll/index")),s=Handlebars.template(function(n,a,e,t,o){function i(n,a){var t,o,i="";return i+=' \n\n\n<div class="item">\n    <div class="wbox clearfix">\n\n        <div class="lbox ">\n            <div class="ui-avatar-icon ui-avatar-icon-m">\n                    <i style="background-image:url(',(o=e.user_icon)?t=o.call(n,{hash:{},data:a}):(o=n&&n.user_icon,t=typeof o===m?o.call(n,{hash:{},data:a}):o),i+=p(t)+')"></i>\n            </div>\n        </div>\n        <div class="rbox ">\n            <div class="box-a">\n                <div class="name f14 color-333">',(o=e.nickname)?t=o.call(n,{hash:{},data:a}):(o=n&&n.nickname,t=typeof o===m?o.call(n,{hash:{},data:a}):o),i+=p(t)+'</div>\n\n                <div class="ui-start-mod">\n                ',t=e.each.call(n,n&&n.stars_list,{hash:{},inverse:_.noop,fn:_.program(2,s,a),data:a}),(t||0===t)&&(i+=t),i+='\n                </div>\n\n            </div>\n\n            <div class="box-b f10 color-aaa">\n                ',(o=e.add_time)?t=o.call(n,{hash:{},data:a}):(o=n&&n.add_time,t=typeof o===m?o.call(n,{hash:{},data:a}):o),i+=p(t)+'\n            </div>\n        </div>\n    </div>\n\n    <div class="des f14 color-333">\n        ',(o=e.comment)?t=o.call(n,{hash:{},data:a}):(o=n&&n.comment,t=typeof o===m?o.call(n,{hash:{},data:a}):o),i+=p(t)+"\n    </div>\n</div>\n\n"}function s(n,a){var t,o="";return o+=" \n                    ",t=e["if"].call(n,n&&n.is_red,{hash:{},inverse:_.program(5,c,a),fn:_.program(3,r,a),data:a}),(t||0===t)&&(o+=t),o+="\n                "}function r(){return'\n                        <i class="icon-s-mod  icon-start-yellow"></i>\n                    '}function c(){return'\n                        <i class="icon-s-mod icon-start-grey"></i>\n                    '}this.compilerInfo=[4,">= 1.0.0"],e=this.merge(e,n.helpers),o=o||{};var l,d="",_=this,m="function",p=this.escapeExpression;return d+="\n\n\n",l=e.each.call(a,a&&a.list,{hash:{},inverse:_.noop,fn:_.program(1,i,o),data:o}),(l||0===l)&&(d+=l),d}),r=n("common/widget/abnormal/index");"addEventListener"in document&&document.addEventListener("DOMContentLoaded",function(){o.attach(document.body)},!1);var c=t({});return a.prototype={refresh:function(){var n=this;n.action(n.options,c.page)},load_more:function(){var n=this;c.has_next_page?(c.page++,n.action(n.options,c.page)):(t.tips({content:"已经到尽头啦",stayTime:3e3,type:"warn"}),c.scroll_view_obj&&c.scroll_view_obj.dragger.reset())},init:function(){var n=this;c.$loading={},c.$no_data=t('[data-role="no-data"]'),c.$has_data=t('[data-role="has-data"]'),c.page=1,c.$comment_container=t('[data-role="comment_ele"]'),c.$scroll_wrapper=t('[data-role="wrapper"]'),c.scroll_view_obj=i(c.$scroll_wrapper),c.scroll_view_obj.on("success:drag_down_load",function(){n.refresh()}),c.scroll_view_obj.on("success:drag_up_load",function(){n.load_more()}),n._setup_event(),n.refresh()},init_tab_container:function(){return{}},action:function(n,a){var o=this;if(o._sending=!1,!o._sending){var n=t.extend(!0,{},n,{page:a});c.ajax_obj=e.ajax_request({url:window.$__ajax_domain+"get_comment_list.php",data:n,beforeSend:function(){o._sending=!0,c.$loading=t.loading({content:"加载中..."})},success:function(n){o._sending=!1,c.$loading.loading("hide");var a=n.result_data;c.trigger("success:get_comment_list",a)},error:function(n){o._sending=!1,c.$loading.loading("hide"),c.trigger("error:get_comment_list",n),t.tips({content:"网络异常",stayTime:3e3,type:"warn"})}})}},_setup_event:function(){c.on("success:get_comment_list",function(n,a){try{c.has_next_page=a.has_next_page,c.scroll_view_obj&&c.scroll_view_obj.dragger.reset(),c.$has_data.removeClass("fn-hide");var e=c.ajax_obj.xhr_data;if(!a.list.length&&1==e.page)return c.$scroll_wrapper.addClass("fn-hide"),void r.render(c.$no_data[0],{});if(a.list.length){var o=s(a),i=1==e.page?"html":"append";c.$comment_container[i](o)}else t.tips({content:a.msg,stayTime:3e3,type:"warn"})}catch(l){console.log(l)}}).on("error:get_comment_list",function(){c.scroll_view_obj&&c.scroll_view_obj.dragger.reset()})}},a});