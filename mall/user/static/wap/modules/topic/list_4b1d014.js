define("topic/list",function(e){var n=Handlebars.template(function(e,n,a,o,i){function r(e,n){var o,i,r="";return r+='\r\n        <li data-role="nav-to-info" data-role-id="',(i=a.id)?o=i.call(e,{hash:{},data:n}):(i=e&&e.id,o=typeof i===s?i.call(e,{hash:{},data:n}):i),r+=c(o)+'">\r\n            <div class="topic-front">\r\n                <i class="image-img" data-lazyload-url="',(i=a.cover_image)?o=i.call(e,{hash:{},data:n}):(i=e&&e.cover_image,o=typeof i===s?i.call(e,{hash:{},data:n}):i),r+=c(o)+'"></i>\r\n            </div>\r\n        </li>\r\n    '}this.compilerInfo=[4,">= 1.0.0"],a=this.merge(a,e.helpers),i=i||{};var t,l="",s="function",c=this.escapeExpression,d=this;return l+="\r\n\r\n    ",t=a.each.call(n,n&&n.arr,{hash:{},inverse:d.noop,fn:d.program(1,r,i),data:i}),(t||0===t)&&(l+=t),l+="\r\n\r\n\r\n\r\n"}),a=e("components/zepto/zepto.js"),o=e("common/scroll/index"),i=e("common/utility/index"),r=(e("yue_ui/frozen"),e("menu/index"),e("common/widget/abnormal/index"),e("common/lazyload/lazyload"));a(function(){var e=a({}),t=function(){var e=this;e.init()};t.prototype={refresh:function(){var n=this;e.page=1,n.action(e.page)},load_more:function(){var n=this;console.log(e.has_next_page),e.has_next_page?(e.page++,n.action(e.page)):(a.tips({content:"已经到尽头啦",stayTime:3e3,type:"warn"}),e.scroll_view_obj&&e.scroll_view_obj.dragger.reset())},init:function(){var n=this;e.$loading={},e.page=1,e.$scroll_wrapper=a('[data-role="wrapper"]'),e.scroll_view_obj=o(e.$scroll_wrapper),e.scroll_view_obj.on("success:drag_down_load",function(){n.refresh()}),e.scroll_view_obj.on("success:drag_up_load",function(){n.load_more()}),n._setup_event(),n.refresh()},action:function(o){var r=this;r._sending=!1,r._sending||(e.ajax_obj=i.ajax_request({url:window.$__config.ajax_url.get_topic_list,data:{page:o},cache:!0,beforeSend:function(){r._sending=!0,e.$loading=a.loading({content:"加载中..."})},success:function(o){r._sending=!1,e.$loading.loading("hide");var i=o.result_data,t=i.list;e.has_next_page=i.has_next_page;var l=n({arr:t}),s=a('[data-role="insert"]');1==e.page?s.html(l):s.append(l),e.trigger("success:get_list",i),a('[data-role="nav-to-info"]').on("click",function(){var e=a(this).attr("data-role-id");window.location.href="./index.php?topic_id="+e})},error:function(n){r._sending=!1,e.$loading.loading("hide"),e.trigger("error:get_list",n),a.tips({content:"网络异常",stayTime:3e3,type:"warn"})}}))},_setup_event:function(){var n=this;e.on("success:get_list",function(){n.lazyloading?n.lazyloading.refresh():n.lazyloading=new r(e.$scroll_wrapper,{size:window.innerWidth-20}),e.scroll_view_obj&&e.scroll_view_obj.dragger.reset()}).on("error:get_list",function(){e.scroll_view_obj&&e.scroll_view_obj.dragger.reset()})}},e.list_obj=new t})});