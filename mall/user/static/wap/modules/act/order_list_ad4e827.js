define("act/order_list",function(t,n){var a=t("common/utility/index"),e=t("components/zepto/zepto.js"),i=t("components/fastclick/fastclick.js"),o=(t("yue_ui/frozen"),t("common/I_APP/I_APP")),l=t("common/scroll/index"),r=t("common/widget/abnormal/index"),d=Handlebars.template(function(t,n,a,e,i){function o(){return'\n                    <div class="tips-con-red">\n                        <div class="tips">官方</div>\n                        <div class="delta"></div>\n                    </div>\n                '}function l(){return'\n                    <div class="tips-con-green">\n                        <div class="tips">免费</div>\n                        <div class="delta"></div>\n                    </div>\n                '}function r(){return'\n                    <div class="tips-con-orange">\n                        <div class="tips">推荐</div>\n                        <div class="delta"></div>\n                    </div>\n                '}function d(){return'\n                    <div class="pic-fade"></div>\n                    <div class="icon icon-pic-reject pic-logo-reject"></div>\n                '}function s(){return'\n                    <div class="pic-fade"></div>\n                    <div class="icon icon-pic-no-reject pic-logo-no-reject"></div>\n                '}function c(t,n){var e,i="";return i+="\n                    ",e=a["if"].call(t,(e=t&&t.data,null==e||e===!1?e:e.is_comment),{hash:{},inverse:S.noop,fn:S.program(12,u,n),data:n}),(e||0===e)&&(i+=e),i+="\n                "}function u(t,n){var e,i="";return i+="\n                        ",e=a["if"].call(t,(e=t&&t.data,null==e||e===!1?e:e.stars_list),{hash:{},inverse:S.noop,fn:S.program(13,_,n),data:n}),(e||0===e)&&(i+=e),i+="\n                    "}function _(t,n){var e,i="";return i+='\n                            <p class="detail">\n                                <i class="icon icon-act-list-starts"></i>\n                                ',e=a.each.call(t,(e=t&&t.data,null==e||e===!1?e:e.stars_list),{hash:{},inverse:S.noop,fn:S.program(14,p,n),data:n}),(e||0===e)&&(i+=e),i+="\n                            </p>\n                        "}function p(t,n){var e,i="";return i+="\n                                    ",e=a["if"].call(t,t&&t.is_red,{hash:{},inverse:S.program(17,f,n),fn:S.program(15,v,n),data:n}),(e||0===e)&&(i+=e),i+="\n                                "}function v(){return'\n                                        <i class="icon icon-stat-s-y"></i>\n                                    '}function f(){return'\n                                        <i class="icon icon-stat-s-g"></i>\n                                    '}function h(t){var n,a="";return a+='\n                    <!--p class="detail" data-role="pub_notice">'+H((n=t&&t.data,n=null==n||n===!1?n:n.pub_btn_notice_text,typeof n===D?n.apply(t):n))+"</p-->\n                "}function b(){return'style="border-top: none"'}function g(t){var n,a="";return a+='\n\n            <button class="ui-button  ui-button-block  ui-button-size-x ui-button-bd-ff6" data-prev-default="1" data-role="btn_unpaid_pay" data-event-id="'+H((n=t&&t.data,n=null==n||n===!1?n:n.event_id,typeof n===D?n.apply(t):n))+'" data-enroll-id="'+H((n=t&&t.data,n=null==n||n===!1?n:n.enroll_id,typeof n===D?n.apply(t):n))+'">\n                <span class="ui-button-content">支付</span>\n            </button>\n        '}function m(t){var n,a="";return a+='\n            <button class="ui-button ui-button-block ui-button-size-x ui-button-bd-aaa" data-prev-default="1" data-role="btn_unpaid_delete" data-event-id="'+H((n=t&&t.data,n=null==n||n===!1?n:n.event_id,typeof n===D?n.apply(t):n))+'" data-enroll-id="'+H((n=t&&t.data,n=null==n||n===!1?n:n.enroll_id,typeof n===D?n.apply(t):n))+'">\n                <span class="ui-button-content">取消</span>\n            </button>\n        '}function y(t){var n,a="";return a+='\n            <button class="ui-button ui-button-block ui-button-size-x ui-button-bd-555" data-event-id="'+H((n=t&&t.data,n=null==n||n===!1?n:n.event_id,typeof n===D?n.apply(t):n))+'" data-enroll-id="'+H((n=t&&t.data,n=null==n||n===!1?n:n.enroll_id,typeof n===D?n.apply(t):n))+'" data-role="btn_pub_show_ewm">\n                <span class="ui-button-content">出示活动券</span>\n            </button>\n        '}function w(t){var n,a="";return a+='\n            <button class="ui-button ui-button-block ui-button-size-x ui-button-bd-555" data-can-comment="1" data-prev-default="1" data-table-id="'+H((n=t&&t.data,n=null==n||n===!1?n:n.table_id,typeof n===D?n.apply(t):n))+'"  data-to-date-id="'+H((n=t&&t.data,n=null==n||n===!1?n:n.to_date_id,typeof n===D?n.apply(t):n))+'" data-event-id="'+H((n=t&&t.data,n=null==n||n===!1?n:n.event_id,typeof n===D?n.apply(t):n))+'" data-role="btn_paid_commit">\n                <span class="ui-button-content">评价活动</span>\n            </button>\n        '}function j(t){var n,a="";return a+='\n            <button class="ui-button ui-button-block ui-button-size-x ui-button-bd-555" data-prev-default="1" data-event-id="'+H((n=t&&t.data,n=null==n||n===!1?n:n.event_id,typeof n===D?n.apply(t):n))+'" data-role="btn_pub_finnish">\n                <span class="ui-button-content">完成活动</span>\n            </button>\n        '}function x(t){var n,a="";return a+='\n            <button class="ui-button ui-button-block ui-button-size-x ui-button-bd-555" data-prev-default="1" data-event-id="'+H((n=t&&t.data,n=null==n||n===!1?n:n.event_id,typeof n===D?n.apply(t):n))+'" data-role="btn_pub_scan">\n                <span class="ui-button-content">扫码签到</span>\n            </button>\n        '}function k(){return'\n            <div class="btn_unpaid_container">\n\n\n            </div>\n        '}function $(t,n){var e,i="";return i+='\n            <div class="btn_paid_container">\n                ',e=a["if"].call(t,(e=t&&t.data,null==e||e===!1?e:e.is_end),{hash:{},inverse:S.program(44,A,n),fn:S.program(38,T,n),data:n}),(e||0===e)&&(i+=e),i+="\n            </div>\n        "}function T(t,n){var e,i="";return i+="\n                    ",e=a["if"].call(t,(e=t&&t.data,null==e||e===!1?e:e.show_comment_btn),{hash:{},inverse:S.noop,fn:S.program(39,q,n),data:n}),(e||0===e)&&(i+=e),i+="\n                "}function q(t,n){var e,i="";return i+="\n                        ",e=a["if"].call(t,(e=t&&t.data,null==e||e===!1?e:e.is_comment),{hash:{},inverse:S.program(42,P,n),fn:S.program(40,z,n),data:n}),(e||0===e)&&(i+=e),i+="\n                    "}function z(){return"\n                        "}function P(){return"\n\n                        "}function A(t,n){var e,i="";return i+="\n                    ",e=a["if"].call(t,(e=t&&t.data,null==e||e===!1?e:e.show_scan_btn),{hash:{},inverse:S.noop,fn:S.program(45,C,n),data:n}),(e||0===e)&&(i+=e),i+="\n                "}function C(){return"\n\n                    "}function E(t,n){var e,i="";return i+='\n            <div class="btn_pub_container">\n                ',e=a["if"].call(t,(e=t&&t.data,null==e||e===!1?e:e.event_finish_button),{hash:{},inverse:S.noop,fn:S.program(48,I,n),data:n}),(e||0===e)&&(i+=e),i+="\n                ",e=a["if"].call(t,(e=t&&t.data,null==e||e===!1?e:e.event_scan_button),{hash:{},inverse:S.noop,fn:S.program(48,I,n),data:n}),(e||0===e)&&(i+=e),i+="\n\n            </div>\n        "}function I(){return"\n\n                "}this.compilerInfo=[4,">= 1.0.0"],a=this.merge(a,t.helpers),i=i||{};var L,M="",S=this,D="function",H=this.escapeExpression;return M+='\n<div class="child" data-role="event-item" data-enroll-id="'+H((L=n&&n.data,L=null==L||L===!1?L:L.enroll_id,typeof L===D?L.apply(n):L))+'" data-event_id="'+H((L=n&&n.data,L=null==L||L===!1?L:L.event_id,typeof L===D?L.apply(n):L))+'" data-view-type="'+H((L=n&&n.data,L=null==L||L===!1?L:L.view_type,typeof L===D?L.apply(n):L))+'" data-audit_status="'+H((L=n&&n.data,L=null==L||L===!1?L:L.audit_status,typeof L===D?L.apply(n):L))+'">\n    <div class="lists" data-role="lists-to-info" data-org-id="'+H((L=n&&n.data,L=null==L||L===!1?L:L.user_id,typeof L===D?L.apply(n):L))+'" data-enroll-id="'+H((L=n&&n.data,L=null==L||L===!1?L:L.enroll_id,typeof L===D?L.apply(n):L))+'" data-event_id="'+H((L=n&&n.data,L=null==L||L===!1?L:L.event_id,typeof L===D?L.apply(n):L))+'" data-view-type="'+H((L=n&&n.data,L=null==L||L===!1?L:L.view_type,typeof L===D?L.apply(n):L))+'" data-audit_status="'+H((L=n&&n.data,L=null==L||L===!1?L:L.audit_status,typeof L===D?L.apply(n):L))+'">\n        <a class="db" href="./detail.php?event_id='+H((L=n&&n.data,L=null==L||L===!1?L:L.event_id,typeof L===D?L.apply(n):L))+'">\n            <i class="child-img " style="background-image: url(\''+H((L=n&&n.data,L=null==L||L===!1?L:L.cover_image,typeof L===D?L.apply(n):L))+"')\">\n\n                ",L=a["if"].call(n,(L=n&&n.data,null==L||L===!1?L:L.is_authority),{hash:{},inverse:S.noop,fn:S.program(1,o,i),data:i}),(L||0===L)&&(M+=L),M+="\n                ",L=a["if"].call(n,(L=n&&n.data,null==L||L===!1?L:L.is_free),{hash:{},inverse:S.noop,fn:S.program(3,l,i),data:i}),(L||0===L)&&(M+=L),M+="\n                ",L=a["if"].call(n,(L=n&&n.data,null==L||L===!1?L:L.is_recommend),{hash:{},inverse:S.noop,fn:S.program(5,r,i),data:i}),(L||0===L)&&(M+=L),M+="\n                ",L=a["if"].call(n,(L=n&&n.data,null==L||L===!1?L:L.pic_show_reject),{hash:{},inverse:S.noop,fn:S.program(7,d,i),data:i}),(L||0===L)&&(M+=L),M+="\n                ",L=a["if"].call(n,(L=n&&n.data,null==L||L===!1?L:L.pic_show_no_reject),{hash:{},inverse:S.noop,fn:S.program(9,s,i),data:i}),(L||0===L)&&(M+=L),M+='\n\n\n            </i>\n        </a>\n\n        <div class="child-text">\n            <a class="db" href="./order_detail.php?enroll_id='+H((L=n&&n.data,L=null==L||L===!1?L:L.enroll_id,typeof L===D?L.apply(n):L))+"&event_id="+H((L=n&&n.data,L=null==L||L===!1?L:L.event_id,typeof L===D?L.apply(n):L))+'">\n                <p class="title">'+H((L=n&&n.data,L=null==L||L===!1?L:L.title,typeof L===D?L.apply(n):L))+'</p>\n                <p class="detail">\n                    <i class="icon icon-act-list-athor"></i>\n                    '+H((L=n&&n.data,L=null==L||L===!1?L:L.nickname,typeof L===D?L.apply(n):L))+'</p>\n                <p class="detail">\n                    <i class="icon icon-act-list-date"></i>\n                    '+H((L=n&&n.data,L=null==L||L===!1?L:L.start_time,typeof L===D?L.apply(n):L))+'</p>\n                <p class="detail">\n                    <i class="icon icon-act-list-price"></i>\n                    ￥'+H((L=n&&n.data,L=null==L||L===!1?L:L.budget,typeof L===D?L.apply(n):L))+"/人</p>\n                ",L=a["if"].call(n,(L=n&&n.data,null==L||L===!1?L:L.is_end),{hash:{},inverse:S.noop,fn:S.program(11,c,i),data:i}),(L||0===L)&&(M+=L),M+='\n                <p class="detail"><i class="icon icon-act-list-join-num"></i>'+H((L=n&&n.data,L=null==L||L===!1?L:L.event_join,typeof L===D?L.apply(n):L))+"人</p>\n                ",L=a["if"].call(n,(L=n&&n.data,null==L||L===!1?L:L.pub_btn_notice),{hash:{},inverse:S.noop,fn:S.program(19,h,i),data:i}),(L||0===L)&&(M+=L),M+='\n            </a>\n        </div>\n\n    </div>\n\n    <div class="list-btns" data-role="list-btns" ',L=a["if"].call(n,(L=n&&n.data,null==L||L===!1?L:L.hide_line),{hash:{},inverse:S.noop,fn:S.program(21,b,i),data:i}),(L||0===L)&&(M+=L),M+=">\n        ",L=a["if"].call(n,(L=n&&n.data,null==L||L===!1?L:L.enroll_pay_button),{hash:{},inverse:S.noop,fn:S.program(23,g,i),data:i}),(L||0===L)&&(M+=L),M+="\n        ",L=a["if"].call(n,(L=n&&n.data,null==L||L===!1?L:L.enroll_cancel_button),{hash:{},inverse:S.noop,fn:S.program(25,m,i),data:i}),(L||0===L)&&(M+=L),M+="\n        ",L=a["if"].call(n,(L=n&&n.data,null==L||L===!1?L:L.enroll_code_button),{hash:{},inverse:S.noop,fn:S.program(27,y,i),data:i}),(L||0===L)&&(M+=L),M+="\n        ",L=a["if"].call(n,(L=n&&n.data,null==L||L===!1?L:L.enroll_comment_button),{hash:{},inverse:S.noop,fn:S.program(29,w,i),data:i}),(L||0===L)&&(M+=L),M+="\n        ",L=a["if"].call(n,(L=n&&n.data,null==L||L===!1?L:L.event_finish_button),{hash:{},inverse:S.noop,fn:S.program(31,j,i),data:i}),(L||0===L)&&(M+=L),M+="\n        ",L=a["if"].call(n,(L=n&&n.data,null==L||L===!1?L:L.event_scan_button),{hash:{},inverse:S.noop,fn:S.program(33,x,i),data:i}),(L||0===L)&&(M+=L),M+="\n\n\n        ",L=a["if"].call(n,(L=n&&n.data,null==L||L===!1?L:L.btn_type_unpaid),{hash:{},inverse:S.noop,fn:S.program(35,k,i),data:i}),(L||0===L)&&(M+=L),M+="\n        ",L=a["if"].call(n,(L=n&&n.data,null==L||L===!1?L:L.btn_type_paid),{hash:{},inverse:S.noop,fn:S.program(37,$,i),data:i}),(L||0===L)&&(M+=L),M+="\n        ",L=a["if"].call(n,(L=n&&n.data,null==L||L===!1?L:L.btn_type_pub),{hash:{},inverse:S.noop,fn:S.program(47,E,i),data:i}),(L||0===L)&&(M+=L),M+="\n    </div>\n</div>\n\n\n\n"}),s=t("common/widget/header/main");"addEventListener"in document&&document.addEventListener("DOMContentLoaded",function(){i.attach(document.body)},!1),n.init=function(){var t=e({}),n=function(){var t=this;t.init(),o.isPaiApp&&o.showtopmenu(!1)};n.prototype={refresh:function(){var n=this;t.page=1,n.action(t.type,t.page)},load_more:function(){var n=this;t.has_next_page?(t.page++,n.action(t.type,t.page)):(e.tips({content:"已经到尽头啦",stayTime:3e3,type:"warn"}),t.scroll_view_obj&&t.scroll_view_obj.dragger.reset())},init:function(){var n=this;t._page_params=_page_params.result_data,t.$tab_container=e(".ui-tab"),t.tab_obj=n.init_tab_container(".ui-tab"),t.$loading={},t.$no_data=e('[data-role="no-data"]'),t.$has_data=e('[data-role="has-data"]'),t.page=1,t.type=t._page_params.type,t.$status_container=e('[data-role="status-container"]'),t.$scroll_wrapper=e('[data-role="wrapper"]'),t.scroll_view_obj=l(t.$scroll_wrapper),t.scroll_view_obj.on("success:drag_down_load",function(){n.refresh()}),t.scroll_view_obj.on("success:drag_up_load",function(){n.load_more()}),s.init({ele:e("#global-header"),title:"标题内容",header_show:!0,right_icon_show:!1,share_icon:{show:!1,content:""},omit_icon:{show:!1,content:""},show_txt:{show:!0,content:"",style:""}}),n._setup_event(),n.refresh()},init_tab_container:function(){return{}},action:function(n,i){var o=this;o._sending=!1,o._sending||(t.ajax_obj=a.ajax_request({url:window.$__ajax_domain+"get_my_act_list.php",data:{type:n,page:i},beforeSend:function(){o._sending=!0,t.$loading=e.loading({content:"加载中..."})},success:function(n){o._sending=!1,t.$loading.loading("hide");var a=n.result_data;t.trigger("success:get_my_act_list",a)},error:function(n){o._sending=!1,t.$loading.loading("hide"),t.trigger("error:get_my_act_list",n),e.tips({content:"网络异常",stayTime:3e3,type:"warn"})}}))},_setup_event:function(){var n=this;t.on("success:get_my_act_list",function(a,e){t.has_next_page=e.has_next_page,t.scroll_view_obj&&t.scroll_view_obj.dragger.reset(),t.$has_data.removeClass("fn-hide");var i=t.ajax_obj.xhr_data;if(!e.list.length&&1==i.page)return t.$has_data.addClass("fn-hide"),t.$no_data.removeClass("fn-hide").html(""),void r.render(t.$no_data[0],{});if(e.code>0){var o=n.render_card(e,t.type).join(""),l=1==i.page?"html":"append";t.$status_container[l](o)}n._setup_button_event()}).on("error:get_my_act_list",function(){t.scroll_view_obj&&t.scroll_view_obj.dragger.reset()})},_setup_button_event:function(){var t=this;e('[data-role="btn_unpaid_pay"]').on("click",function(t){var n=e(t.currentTarget),a=n.attr("data-event-id"),i=n.attr("data-enroll-id");window.location.href="./pay.php?event_id="+a+"&enroll_id="+i}),e('[data-role="btn_unpaid_delete"]').on("click",function(n){var a=e(n.currentTarget),i=(a.attr("data-event-id"),a.attr("data-enroll-id"));confirm("是否取消报名")&&t.set_act_status({enroll_id:i,type:"del_enroll"})}),e('[data-role="lists-to-info"]').on("click",function(n){var a,i=e(n.currentTarget),o=i.attr("data-enroll-id"),l=i.attr("data-view-type"),r=(i.attr("data-event_id"),i.attr("data-audit_status"));if("0"==r)return void alert("该活动在审核当中");if("2"==r)return void alert("该活动未通过审核","error");if(console.log(o),o)switch(l){case"unpaid":a=t.uppaid_view.search_data_by_id(o);break;case"paid":a=t.paid_view.search_data_by_id(o);break;case"pub":a=t.pub_view.search_data_by_id(o)}else;}),e('[data-role="btn_pub_show_ewm"]').on("click",function(t){var n=e(t.currentTarget),i=n.attr("data-event-id"),l=n.attr("data-enroll-id");a.ajax_request({url:window.$__ajax_domain+"get_act_ticket_detail.php",data:{event_id:i,enroll_id:l},success:function(t){var n=t.result_data.data;if(0==n.length)return void alert("二维码不存在");for(var e=Math.ceil(a.get_view_port_width()-90),i=e+35,l=0;l<n.length;l++)n[l]={code:n[l].code,qr_code:n[l].qr_code_url,pic_w_h:e,out_height:i,url:n[l].qr_code_url,number:n[l].code,name:"数字密码"};if(o.isPaiApp)o.qrcodeshow(n);else{var t={qr_code_arr:n,pic_w_h:e,out_height:i};qr_tpl(t)}},error:function(){}})}),e('[data-role="btn_paid_commit"]').on("click",function(t){{var n=e(t.currentTarget),a=n.attr("data-event-id"),i=(n.attr("data-to-date-id"),n.attr("data-table-id")),o=n.attr("data-can-comment");n.attr("data-org-id")}o&&(window.location.href="../comment/?event_id="+a+"&table_id="+i+"&type=event")}),e('[data-role="btn_pub_finnish"]').on("click",function(n){var a=e(n.currentTarget),i=a.attr("data-event-id");confirm("是否结束活动")&&t.set_act_status({event_id:i,type:"end"})}),e('[data-role="btn_pub_cencel"]').on("click",function(n){var a=e(n.currentTarget),i=a.attr("data-event-id");confirm("是否取消活动")&&t.set_act_status({event_id:i,type:"cancel"})}),e('[data-role="btn_pub_scan"]').on("click",function(t){var n=e(t.currentTarget),a=n.attr("data-event-id");window.location.href="./sign.php?event_id="+a})},render_card:function(t,n){var a=[];return e.each(t.list,function(t,i){var o=!1;switch(n){case"unpaid":o=!(i.event_detail.enroll_pay_button||i.event_detail.enroll_cancel_button);break;case"paid":o=!(i.event_detail.enroll_code_button||i.event_detail.enroll_comment_button);break;case"pub":o=!(i.event_detail.event_finish_button||i.event_detail.event_scan_button)}switch(i.event_detail=e.extend(!0,{},i.event_detail,{view_type:n,hide_line:o,enroll_id:i.enroll_id}),i.event_detail.audit_status){case"0":i.event_detail=e.extend(!0,i.event_detail,{pic_show_reject:0,pic_show_no_reject:1});break;case"1":i.event_detail=e.extend(!0,i.event_detail,{pic_show_reject:0,pic_show_no_reject:0});break;case"2":i.event_detail=e.extend(!0,i.event_detail,{pic_show_reject:1,pic_show_no_reject:0})}var l=d({data:i.event_detail});a.push(l)}),a},set_act_status:function(n){var i=this;n=n||{},i._sending=!1,i._sending||a.ajax_request({url:window.$__ajax_domain+"set_act_status.php",data:n,beforeSend:function(){i._sending=!0,t.$loading=e.loading({content:"加载中..."})},success:function(n){t.$loading.loading("hide"),n.result_data.code?window.location.href=window.location.href:e.tips({content:n.result_data.msg,stayTime:3e3,type:"warn"})},error:function(){t.$loading.loading("hide"),e.tips({content:"网络异常",stayTime:3e3,type:"warn"})}})}};new n}});