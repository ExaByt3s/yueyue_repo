<!doctype html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <title>Mqtt js expamle</title>
</head>
<body>

	<form id="ajaxform" enctype="multipart/form-data" action="http://sendtxt-wifi.yueus.com/sendtxt.cgi" method="POST">
    	<input type="text" name="data" value ="" data-role="submit"/> <br/>
    </form>

	<div data-role="btn">send</div>
</body>
	<script type="text/javascript">
	window.client_id = '100026';

	</script>
    <script src="./lib/jquery-1.10.2.min.js"></script>
    <script src="./lib/browserMqtt.js"></script>
    <script src="./lib/inflate.min.js"></script>
    <script src="./lib/md5-min.js"></script>
    <script src="./main.js"></script>
    <script type="text/javascript">
    $(function() {

        var obj =
        {
            send_user_id : client_id,
            to_user_id : '100019',
            media_type : 'text',
            msg_key : hex_md5(client_id+'100019'+'J&&#3435WS#KSJDF'),
            content : 'hello world',
            send_user_role : 'yueseller',
            from:"agent"
        };

    	$('[data-role="btn"]').on('click',function()
    	{
            var sender = $('[data-role="submit"]').val(JSON.stringify(obj));

            var myFormData = new FormData(document.getElementById('ajaxform'));
            var xhr = new XMLHttpRequest();
            xhr.open('POST','http://sendtxt-wifi.yueus.com/sendtxt.cgi');
            xhr.onload = function(e) {
                if (xhr.status == 200 && xhr.responseText) {
                    // 显示：'欢迎你，' + xhr.responseText;

                }
            }//.bind(document.getElementById('ajaxform'));
            // 发送FormData对象数据
            xhr.send(myFormData);

    	})

    });

    </script>
</html>
