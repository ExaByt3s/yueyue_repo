define("bind_alipay",function(o){"use strict";var n=o("common/utility/index"),i=o("components/zepto/zepto.js"),e=o("components/fastclick/fastclick.js"),a=(o("yue_ui/frozen"),o("common/I_APP/I_APP")),t=(o("common/widget/abnormal/index"),o("menu/index")),c=o("common/widget/uploader/index");"addEventListener"in document&&document.addEventListener("DOMContentLoaded",function(){e.attach(document.body)},!1),function(o,i){var e=o({});a.isPaiApp?a.check_login(function(o){var e=i.__YUE_APP_USER_INFO__,t=n.login_id,c=i.__YUE_APP_USER_INFO__.user_id||0,r=t==c;return console.log("=====local_user_id,client_user_id====="),console.log(t,c),n.ajax_request({url:i.$__config.ajax_url.auth_get_user_info,data:e,cache:!1,async:r}),n.int(o.pocoid)?void 0:void a.openloginpage(function(o){"0000"==o.code&&n.refresh_page()})}):n.auth.is_login()||(i.location.href="../../account/login.php?redirect_url="+encodeURIComponent(i.location.href));var r=[{index:0,content:" ◊“≥",click_event:function(){a.isPaiApp&&a.switchtopage({page:"hot"})}},{index:1,content:"À¢–¬",click_event:function(){i.location.href=i.location.href}}];t.render(o("body"),r);var d=0;n.$_AppCallJSObj.on("__showTopBarMenu",function(){d++,d%2!=0?t.show():t.hide()});var l=function(){var o=this;o.init()};l.prototype={init:function(){var n=this;e.$uploader=o('[data-role="upload-img-container"]'),e.$bind_alipay=o('[data-role="bind-alipay"]'),e.$photo_container=o('[data-role="photo-container"]'),e.$upload_confirm=o('[data-role="upload-confirm"]'),e.$photo_confirm=o('[data-role="photo-confirm"]'),e.$id_pic=o('[data-role="ID-pic"]'),e.$name=o('[data-role="account-name"]'),e.$alipay=o('[data-role="account-alipay"]'),e.$confirm=o('[data-role="confrim"]'),e.$uploader[0]&&(e.uploader_obj=c.render(e.$uploader[0],{}),e.shili_img="http://yp.yueus.com/mobile/images/pai/id_demo.png",n._setup_event())},_setup_event:function(){var t=this;e.uploader_obj.$el.on("click:upload_flag",function(){e.uploader_obj.get().length||t.show_photo_page()}),a.isPaiApp?e.$upload_confirm.on("click",function(){e.uploader_obj.upload_action({callback:function(o){o.length>0&&setTimeout(function(){var i=o[0];i=n.matching_img_size(i,640),e.upload_success_img=i,e.$id_pic.css("background-image","url("+i+")"),e.$photo_confirm.removeClass("disabled")},1e3)}})}):e.uploader_obj.$el.on("upload:success",function(o,i){i&&setTimeout(function(){var o=i;o=n.matching_img_size(o,640),e.upload_success_img=o,e.$id_pic.css("background-image","url("+o+")"),e.$photo_confirm.removeClass("disabled")},1e3)}),e.$photo_confirm.on("click",function(){e.$photo_confirm.hasClass("disabled")||(e.uploader_obj=c.render(e.$uploader[0],{upload:!0,img_url:e.upload_success_img,width:"90px",height:"90px"}),t.hide_photo_page())}),e.$confirm.on("click",function(){var n=e.$alipay.val(),i=e.$name.val(),a=e.uploader_obj.get()[0],c="";return i?n?a||(c="«Î…œ¥´Õº∆¨"):c="«ÎÃÓ–¥÷ß∏∂±¶’À∫≈":c="«ÎÃÓ–¥ƒ„µƒ–’√˚",c?void o.tips({content:c,stayTime:3e3,type:"warn"}):void t.submit({third_account:n,real_name:i,pic:a,type:"bind_act"})}),e.on("submit:success",function(n,e){e.code>0?i.location.href=i.location.href:o.tips({content:e.msg,stayTime:3e3,type:"warn"})}),e.on("submit:error",function(){o.tips({content:"Õ¯¬Á“Ï≥£",stayTime:3e3,type:"warn"})})},refresh:function(){i.location.href=i.location.href},show_photo_page:function(){e.$bind_alipay.addClass("fn-hide"),e.$photo_container.removeClass("fn-hide"),e.$photo_confirm.addClass("disabled"),e.$id_pic.css("background-image","url("+e.shili_img+")")},hide_photo_page:function(){e.$bind_alipay.removeClass("fn-hide"),e.$photo_container.addClass("fn-hide")},submit:function(a){var t=this;t._sending=!1,t._sending||n.ajax_request({url:i.$__config.ajax_url.bind_alipay,data:a,beforeSend:function(){e.$loading=o.loading({content:"∑¢ÀÕ÷–..."})},success:function(o){t._sending=!1,e.$loading.loading("hide");var n=o.result_data;e.trigger("submit:success",n)},error:function(){t._sending=!1,e.$loading.loading("hide"),e.trigger("submit:error",res),o.tips({content:"Õ¯¬Á“Ï≥£",stayTime:3e3,type:"warn"})}})}};new l}(i,window)});