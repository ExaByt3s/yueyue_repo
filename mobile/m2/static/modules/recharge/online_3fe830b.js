define("recharge/online",function(e){"use strict";var a=e("common/utility/index"),t=e("components/zepto/zepto.js"),n=e("components/fastclick/fastclick.js"),c=(e("yue_ui/frozen"),e("common/I_APP/I_APP")),i=e("common/ua/index");"addEventListener"in document&&document.addEventListener("DOMContentLoaded",function(){n.attach(document.body)},!1),function(e,t){c.isPaiApp?c.check_login(function(e){return a.int(e.pocoid)?void 0:void c.openloginpage(function(e){"0000"==e.code&&a.refresh_page()})}):a.auth.is_login()||(t.location.href="../account/login.php?redirect_url="+encodeURIComponent(t.location.href));var n={};n.quotes_id=e("#quotes_id").val(),n.$page_container=e('[data-role="page-container"]');var s=function(){var e=this;e.init()};s.prototype={refresh:function(){},page_back:function(){},init:function(){var e=this;e.setup_event()},hide:function(){},setup_event:function(){var s=this;n.$pay_li=e('[data-role="pay-li"]'),n.$select_price=e('[data-role="select-recharge-price"]'),n.$recharge_btn=e('[data-role="recharge-btn"]'),i.is_normal_wap?e('[data-pay-type="tenpay_wxapp"]').addClass("fn-hide"):i.is_weixin&&(e('[data-pay-type="alipay_purse"]').addClass("fn-hide"),e('[data-pay-type="tenpay_wxapp"]').addClass("fn-hide")),n.$pay_li.each(function(a,t){e(t).find('[data-role="yes-tag"]').hasClass("icon-select-active")&&(n.selected_pay_action_type=e(t).attr("data-pay-type"))}),n.$select_price.each(function(a,t){e(t).find('[data-role="yes-tag"]').hasClass("icon-select-active")&&(n.$select_price_val=e(t).attr("data-price"))}),n.$select_price.on("click",function(a){{var t=e(a.currentTarget),c=t.find('[data-role="yes-tag"]');c.hasClass("icon-select-active")}n.$select_price.find('[data-role="yes-tag"]').removeClass("icon-select-active").addClass("icon-select-no"),c.addClass("icon-select-active").removeClass("icon-select-no"),n.$select_price_val=t.attr("data-price")}),n.$pay_li.on("click",function(a){{var t=e(a.currentTarget),c=t.find('[data-role="yes-tag"]');c.hasClass("icon-select-active")}n.$pay_li.find('[data-role="yes-tag"]').removeClass("icon-select-active").addClass("icon-select-no"),c.addClass("icon-select-active").removeClass("icon-select-no");var i=t.attr("data-pay-type");n.selected_pay_action_type=i}),n.$recharge_btn.on("click",function(){var r=n.$select_price_val,o=n.selected_pay_action_type;if(confirm("确定充值?")){if(!r)return void e.tips({content:"请选择充值金额",stayTime:3e3,type:"warn"});if(!o)return void e.tips({content:"请选择支付方式",stayTime:3e3,type:"warn"});var l=t.location,p="http://yp.yueus.com/mobile/";if(/predev/.test(l.href))var d="m2predev/recharge/success.php";else var d="m2/recharge/success.php";var _={};i.is_normal_wap&&"alipay_purse"==o&&(o="alipay_wap"),a.ajax_request({url:t.$__config.ajax_url.recharge,type:"POST",data:{type:"recharge",third_code:o,amount:r,redirect_url:p+d},beforeSend:function(){_=e.loading({content:"发送中..."})},success:function(n){_.loading("hide");var i=n.result_data&&n.result_data.third_code,o=p+d+"?"+n.result_data.payment_no;if(n.result_data.code>0)var l="success";else var l="warn";switch(e.tips({content:n.result_data.message,stayTime:3e3,type:l}),i){case"alipay_purse":c.alipay({alipayparams:n.result_data.data,payment_no:n.result_data.payment_no},function(n){var c=a.int(n.result),i=s.after_pay_text(c);e.tips({content:i,stayTime:3e3,type:"success"}),(1==c||-1==c||-2==c)&&(t.location.href=o)});break;case"alipay_wap":if(1==n.result_data.code)t.location.href=n.result_data.data;else{var u=s.after_pay_text(n.result_data.code);e.tips({content:u,stayTime:3e3,type:"warn"})}break;case"tenpay_wxapp":c.wxpay(JSON.parse(n.result_data.data),function(n){var c=a.int(n.result),i=s.after_pay_text(c);e.tips({content:i,stayTime:3e3,type:"success"}),(1==c||-1==c||-2==c)&&(t.location.href=o)});break;case"tenpay_wxpub":t.location.href="http:://yp.yueus.com/m/pay_jump.php?pay_price="+r+"&r_url="+encodeURIComponent(o)}},error:function(){_.loading("hide"),e.tips({content:"网络异常",stayTime:3e3,type:"warn"})}})}})},clear_select:function(e){var a=n.$pay_li.find('[data-role="yes-tag"]');e?n.$select_ab_btn.find('[data-role="yes-tag"]').removeClass("icon-select-active").addClass("icon-select-no"):a.removeClass("icon-select-active").addClass("icon-select-no")},after_pay_text:function(e){var t="";switch(a.int(e)){case 1:case-2:case-1:t="支付成功";break;case 0:t="其它错误";break;case-3:t="支付失败";break;case-4:t="支付取消"}return t}};var r=new s;r.refresh()}(t,window)});